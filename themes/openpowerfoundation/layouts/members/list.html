{{ partial "header.html" . }}
{{ partial "navbar.html" . }}
{{ $i := 0 }}
{{ $now := now.Format "20060102" }}
<main id="main" class="main members">
<div class="container">
	<section id="intro">
	<div class="row">
		<h1 class="section-header my-3 my-md-5 pb-2 pb-md-3 text-center">{{ .Title }}</h1>
	</div>
	</section>
	<div class="row">
	{{ $data := index $.Site.Data }}
	{{ range $data.memberlevels }}
		<div class="col-lg-12">
			<div class="membership-level pt-5 pb-0 pb-lg-3">
				<h2 class="pb-2 pb-lg-5 text-center">{{ .name }}</h2>
				{{ $key := .identifier }}
				{{ $imageheight := .image.height }}
				{{ $imagewidth := .image.width }}
				{{ $imagesize := printf "%s webp" .size  }}
				{{ $col := .col }}
				<div class="row d-flex justify-content-center">
				{{ range $.Site.Pages.ByTitle }}
					{{ $level := .Param "level" }}
					{{ if eq $level $key }}
						<div class="col-lg-{{ $col }} pt-5 pb-0 pb-lg-3">
							{{ $memberstatus := true }}
							{{ $cancelled := now.Format "20060102" }}
							{{ if isset .Params "cancelled" }}
								{{ $cancelled = time (.Param "cancelled") | dateFormat "20060102" }}
								{{ if lt $cancelled $now }}
									{{ $memberstatus = false }}
								{{ end }}
							{{ end }}
							{{ if eq $memberstatus true }}
								<div class="box">
									<a href="{{ .RelPermalink }}">
									{{ if .Param "image" }}
										{{ $imagename := .Param "image" }}
										{{ $imagelocation := (printf "%s/%s" "images/members/" $imagename) }}
										{{ $imageresource := resources.Get $imagelocation }}
										{{ $image := $imageresource.Fit $imagesize }}
										<img src="{{  $image.RelPermalink }}" alt="{{ .Title }}" title="{{ .Title }}">
									</a>
									{{ else }}
										<h3><a class="text-black" href="{{ .RelPermalink  }}">{{ .Title }}</a></h3>
									{{ end }}
									{{ $i = add $i 1 }}
								</div>
							{{ end }}
						</div>
					{{ end }}
				{{ end }}
				</div>
			</div>
		</div>
		{{ end }}
	</div>
</div>
</main>
{{ partial "footer.html" . }}
